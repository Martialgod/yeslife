angular.module("app",["AppServices"]).constant("API_URL","/admin/usertype").config(["$httpProvider",function(e){e.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"}]).controller("UserTypeModulesController",["$http","$compile","$scope","API_URL","SQLSTATEFactory","GlobalFactory",function(e,o,t,n,s,l){var u=this;u.modules=[];var c=$("#pk_usertype").val().trim();l.blockUICustom("#main-div"),setTimeout(function(){e.get("/admin/usertype/"+c+"/modules?"+Math.random()).then(function(e){var o=e.data;l.unblockUICustom("#main-div"),"object"==typeof o&&Object.keys(o).length>0&&o.A.forEach(function(e,t){u.modules.push(e),u.modules[u.modules.length-1].selected=null!=e.fk_usertype,"1000"==e.pk_permalink&&(u.modules[u.modules.length-1].selected=!0,u.modules[u.modules.length-1].isdefault=!0),u.modules[u.modules.length-1].tips="",o.B.forEach(function(t,n){e.family==t.family&&(u.modules.push(t),u.modules[u.modules.length-1].indent="&nbsp;&nbsp;&nbsp;&nbsp;",u.modules[u.modules.length-1].selected=null!=t.fk_usertype,u.modules[u.modules.length-1].tips="Required ** [ "+e.description+" ]",o.C.forEach(function(e,o){t.route==e.family&&(u.modules.push(e),u.modules[u.modules.length-1].indent="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",u.modules[u.modules.length-1].tips="Required ** [ "+t.description+" ]",u.modules[u.modules.length-1].selected=null!=e.fk_usertype)}))})})},function(e){swal("Opps!","Something went wrong!","error"),console.log(e.data),l.unblockUICustom("#main-div")})},1e3),u.SelectDeselect=function(e,o){if(null!=e){switch(o){case"modules":u.isSelectAllModules=!1}u.LoopSelectedModules(e)}else switch(o){case"modules":var t=u.isSelectAllModules;u.modules.forEach(function(e,o){"1000"!=e.pk_permalink&&(e.selected=t)})}},u.LoopSelectedModules=function(e){u.modules.forEach(function(o,t){"B"==e.type&&e.route==o.family&&(e.selected?o.selected=!0:o.selected=!1)})},u.confirmSubmit=function(){var o=[];u.modules.forEach(function(e,t){e.selected&&o.push(e)});var t=$("#pk_usertype").val().trim();l.blockUICustom("#main-div"),e.post("/admin/usertype/"+t+"/modules",{modules:o}).then(function(e){swal("Success!","Modules updated!","success"),l.unblockUICustom("#main-div")},function(e){swal("Opps!","Something went wrong!","error"),console.log(e.data),l.unblockUICustom("#main-div")})},$("#btnAjaxSubmit").click(function(e){e.preventDefault(),swal({title:"Are you sure you want to continue?",text:"",type:"warning",showCancelButton:!0,focusCancel:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes"}).then(function(e){e.value&&u.confirmSubmit()})})}]);