angular.module("app",["AppServices"]).constant("API_URL","/mail").config(["$httpProvider",function(s){s.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"}]).controller("ProductDetailsController",["$http","SQLSTATEFactory","API_URL","GlobalFactory",function(s,o,t,e){var a=this;a.pk_products=$("#productid").val(),a.search=null,a.mscproducts=[],a.mscreviews=[],a.navlinks={},a.meta={},a.LoadProducts=function(o){o=o||"/shop-search",a.mscproducts=[],s.post(o,{search:a.search}).then(function(s){var o=s.data;$("#searchresultbody").html(""),a.mscproducts=o.data,e.unblockUICustom("#main-div")},function(s){swal("Opps!","Something went wrong!","error"),console.log(s.data),e.unblockUICustom("#main-div")})},a.StringifyStars=function(){a.mscreviews.forEach(function(s,o){s.stars_string="";for(var t=1;t<=s.star;t++)s.stars_string+='<i class="fa fa-star"></i>'})},a.LoadReviews=function(o){o=o||"/shop/"+a.pk_products+"/reviews?v="+Math.random(),a.mscreviews=[],s.get(o).then(function(s){var o=s.data;a.navlinks=o.links,a.meta=o.meta,a.mscreviews=o.data,a.StringifyStars(),hideCustomizeLoading()},function(s){swal("Opps!","Something went wrong!","error"),console.log(s.data),hideCustomizeLoading()})},a.PostReviews=function(o){o.preventDefault(),$("#form-reviews").valid()&&(showCustomizeLoading(),s.post("/shop/"+a.pk_products+"/reviews",$("#form-reviews").serializeArray()).then(function(s){var o=s.data;a.navlinks=o.links,a.meta=o.meta,a.mscreviews=o.data,a.StringifyStars(),hideCustomizeLoading(),$("#comments").val(""),swal("Success","Your review has been posted!","success")},function(s){console.log(s),swal("Opps!","Errors found! <br> Please see logs","error"),hideCustomizeLoading()}))},a.SearchProducts=function(){showCustomizeLoadingNoIcon(),a.mscproducts=[],a.LoadProducts()},showCustomizeLoadingNoIcon(),setTimeout(function(){a.LoadReviews()},500)}]);