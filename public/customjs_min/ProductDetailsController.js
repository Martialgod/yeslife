angular.module("app",["AppServices"]).constant("API_URL","/mail").config(["$httpProvider",function(o){o.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"}]).controller("ProductDetailsController",["$http","SQLSTATEFactory","API_URL","GlobalFactory",function(o,t,s,r){var e=this;e.pk_products=$("#productid").val(),e.search=null,e.mscproducts=[],e.currentproduct={},e.selectedflavor=e.pk_products,e.mscflavors=[],e.mscreviews=[],e.totalreviews=0,e.navlinks={},e.meta={},e.ShowProduct=function(t){t=t||e.pk_products,showCustomizeLoadingNoIcon(),o.get("/apishowproduct/"+t).then(function(o){var t=o.data;e.currentproduct=t.products,e.mscflavors=t.flavors,e.totalreviews=t.totalreviews,e.StringifyStars(),r.unblockUICustom("#main-div"),e.LoadReviews()},function(o){swal("Opps!","Something went wrong!","error"),console.log(o.data),r.unblockUICustom("#main-div")})},e.StringifyStars=function(){e.currentproduct.stars_string="";for(var o=1;o<=e.currentproduct.ratings;o++)e.currentproduct.stars_string+='<i class="fa fa-star"></i>'},e.AddToCart=function(o){var t={productid:o.pk_products,qty:1};addCartCookie(t)},e.GlobalBuyNow=function(o){GlobalBuyNow(o.pk_products,1)},e.LoadReviews=function(t){t=t||"/shop/"+e.selectedflavor+"/reviews?v="+Math.random(),e.mscreviews=[],o.get(t).then(function(o){var t=o.data;e.navlinks=t.links,e.meta=t.meta,e.mscreviews=t.data,e.StringifyStars()},function(o){swal("Opps!","Something went wrong!","error"),console.log(o.data)})},e.PostReviews=function(t){t.preventDefault(),$("#form-reviews").valid()&&(showCustomizeLoading(),o.post("/shop/"+e.pk_products+"/reviews",$("#form-reviews").serializeArray()).then(function(o){var t=o.data;e.navlinks=t.links,e.meta=t.meta,e.mscreviews=t.data,e.StringifyStars(),hideCustomizeLoading(),$("#comments").val(""),swal("Success","Your review has been posted!","success")},function(o){console.log(o),swal("Opps!","Errors found! <br> Please see logs","error"),hideCustomizeLoading()}))},e.SearchProducts=function(t){t=t||"/shop-search",showCustomizeLoadingNoIcon(),e.mscproducts=[],o.post(t,{search:e.search}).then(function(o){var t=o.data;$("#searchresultbody").html(""),e.mscproducts=t.data,r.unblockUICustom("#main-div")},function(o){swal("Opps!","Something went wrong!","error"),console.log(o.data),r.unblockUICustom("#main-div")})},showCustomizeLoadingNoIcon(),setTimeout(function(){e.ShowProduct()},500)}]);